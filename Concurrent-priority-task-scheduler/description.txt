Implement a task scheduler that executes asynchronous tasks with a maximum concurrency limit, prioritizing higher-priority tasks first while preserving the original order of results.

Implement the TaskScheduler class:

TaskScheduler(concurrency: number): Initializes the scheduler with the maximum number of concurrent tasks allowed.

execute(tasks: Array<() => Promise<any>>, priorities: number[]): Promise<Array<{result: any, error: string | null}>>: Executes the given tasks with priority scheduling, where higher priority values indicate more important tasks. Returns results in the same order as the input tasks despite execution order.

Constraints:

1 <= concurrency <= 100

1 <= tasks.length <= 10^4

-10^9 <= priorities[i] <= 10^9

tasks.length === priorities.length

All tasks are functions returning Promises

Failed tasks should not stop other tasks from executing

Higher priority tasks execute first

Tasks with equal priority execute in their original order (stable sort)

Example 1:

javascript

const scheduler = new TaskScheduler(2);
const tasks = [
  () => new Promise(res => setTimeout(() => res('Task 1'), 300)),
  () => new Promise(res => setTimeout(() => res('Task 2'), 200)),
  () => new Promise(res => setTimeout(() => res('Task 3'), 100)),
  () => new Promise(res => setTimeout(() => res('Task 4'), 400))
];
const priorities = [1, 3, 2, 1];

const results = await scheduler.execute(tasks, priorities);
// Execution order: Task 2 (prio 3), Task 3 (prio 2), Task 1 (prio 1), Task 4 (prio 1)
// Results maintain original order:
// [
//   {result: 'Task 1', error: null},
//   {result: 'Task 2', error: null},
//   {result: 'Task 3', error: null},
//   {result: 'Task 4', error: null}
// ]
Example 2:

javascript

const scheduler = new TaskScheduler(1);
const tasks = [
  () => Promise.resolve('Success'),
  () => Promise.reject('Failed task'),
  () => Promise.resolve('Another success')
];
const priorities = [2, 1, 3];

const results = await scheduler.execute(tasks, priorities);
// [
//   {result: 'Success', error: null},
//   {result: null, error: 'Failed task'},
//   {result: 'Another success', error: null}
// ]
Example 3:

javascript

const scheduler = new TaskScheduler(2);
const executionOrder = [];
const tasks = [
  () => { executionOrder.push(0); return 'A'; },
  () => { executionOrder.push(1); return 'B'; },
  () => { executionOrder.push(2); return 'C'; }
];
const priorities = [1, 1, 1]; // All same priority

await scheduler.execute(tasks, priorities);
// Execution order: [0, 1, 2] (original order maintained for equal priorities)
